{"remainingRequest":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/babel-loader/lib/index.js!/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/src/views/system/sysRole/assignAuth.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/src/views/system/sysRole/assignAuth.vue","mtime":1683559688684},{"path":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/babel.config.js","mtime":1682639355350},{"path":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/catherine_sun/Documents/CS degree/Projects/YunShangOA/YunShangOA_frontend/guigu-oa-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCgppbXBvcnQgYXBpIGZyb20gJ0AvYXBpL3N5c3RlbS9zeXNNZW51JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdyb2xlQXV0aCcsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAvLyDnlKjmnaXmoIfor4bmmK/lkKbmraPlnKjkv53lrZjor7fmsYLkuK3nmoTmoIfor4YsIOmYsuatoumHjeWkjeaPkOS6pAogICAgICBzeXNNZW51TGlzdDogW10sCiAgICAgIC8vIOaJgOaciQogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ25hbWUnCiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaERhdGEoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qCiAgICDliJ3lp4vljJYKICAgICovCiAgICBmZXRjaERhdGE6IGZ1bmN0aW9uIGZldGNoRGF0YSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdmFyIHJvbGVJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlkOwogICAgICBhcGkudG9Bc3NpZ24ocm9sZUlkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICB2YXIgc3lzTWVudUxpc3QgPSByZXN1bHQuZGF0YTsKICAgICAgICBfdGhpcy5zeXNNZW51TGlzdCA9IHN5c01lbnVMaXN0OwogICAgICAgIHZhciBjaGVja2VkSWRzID0gX3RoaXMuZ2V0Q2hlY2tlZElkcyhzeXNNZW51TGlzdCk7CiAgICAgICAgY29uc29sZS5sb2coJ2dldFBlcm1pc3Npb25zKCkgY2hlY2tlZElkcycsIGNoZWNrZWRJZHMpOwogICAgICAgIF90aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZEtleXMoY2hlY2tlZElkcyk7CiAgICAgIH0pOwogICAgfSwKICAgIC8qCiAgICDlvpfliLDmiYDmnInpgInkuK3nmoRpZOWIl+ihqAogICAgKi8KICAgIGdldENoZWNrZWRJZHM6IGZ1bmN0aW9uIGdldENoZWNrZWRJZHMoYXV0aHMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciBpbml0QXJyID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBbXTsKICAgICAgcmV0dXJuIGF1dGhzLnJlZHVjZShmdW5jdGlvbiAocHJlLCBpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0uc2VsZWN0ICYmIGl0ZW0uY2hpbGRyZW4ubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICBwcmUucHVzaChpdGVtLmlkKTsKICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uY2hpbGRyZW4pIHsKICAgICAgICAgIF90aGlzMi5nZXRDaGVja2VkSWRzKGl0ZW0uY2hpbGRyZW4sIGluaXRBcnIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcHJlOwogICAgICB9LCBpbml0QXJyKTsKICAgIH0sCiAgICAvKgogICAg5L+d5a2Y5p2D6ZmQ5YiX6KGoCiAgICAqLwogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIGRlYnVnZ2VyOwogICAgICAvL+iOt+WPluWIsOW9k+WJjeWtkOiKgueCuQogICAgICAvL2NvbnN0IGNoZWNrZWROb2RlcyA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkTm9kZXMoKQogICAgICAvL+iOt+WPluWIsOW9k+WJjeWtkOiKgueCueWPiueItuiKgueCuQogICAgICB2YXIgYWxsQ2hlY2tlZE5vZGVzID0gdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWROb2RlcyhmYWxzZSwgdHJ1ZSk7CiAgICAgIHZhciBpZExpc3QgPSBhbGxDaGVja2VkTm9kZXMubWFwKGZ1bmN0aW9uIChub2RlKSB7CiAgICAgICAgcmV0dXJuIG5vZGUuaWQ7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZyhpZExpc3QpOwogICAgICB2YXIgYXNzZ2luTWVudVZvID0gewogICAgICAgIHJvbGVJZDogdGhpcy4kcm91dGUucXVlcnkuaWQsCiAgICAgICAgbWVudUlkTGlzdDogaWRMaXN0CiAgICAgIH07CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGFwaS5kb0Fzc2lnbihhc3NnaW5NZW51Vm8pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIF90aGlzMy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgX3RoaXMzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzdWx0LiRtZXNzYWdlIHx8ICfliIbphY3mnYPpmZDmiJDlip8nKTsKICAgICAgICBfdGhpczMuJHJvdXRlci5wdXNoKCcvc3lzdGVtL3N5c1JvbGUnKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["api","name","data","loading","sysMenuList","defaultProps","children","label","created","fetchData","methods","_this","roleId","$route","query","id","toAssign","then","result","checkedIds","getCheckedIds","console","log","$refs","tree","setCheckedKeys","auths","_this2","initArr","arguments","length","undefined","reduce","pre","item","select","push","save","_this3","allCheckedNodes","getCheckedNodes","idList","map","node","assginMenuVo","menuIdList","doAssign","$message","success","$router"],"sources":["src/views/system/sysRole/assignAuth.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div style=\"padding: 20px 20px 0 20px;\">\n      授权角色：{{ $route.query.roleName }}\n    </div>\n    <el-tree\n      style=\"margin: 20px 0\"\n      ref=\"tree\"\n      :data=\"sysMenuList\"\n      node-key=\"id\"\n      show-checkbox\n      default-expand-all\n      :props=\"defaultProps\"\n    />\n    <div style=\"padding: 20px 20px;\">\n      <el-button :loading=\"loading\" type=\"primary\" icon=\"el-icon-check\" size=\"mini\" @click=\"save\">保存</el-button>\n      <el-button @click=\"$router.push('/system/sysRole')\" size=\"mini\" icon=\"el-icon-refresh-right\">返回</el-button>\n    </div>\n  </div>\n</template>\n<script>\n  import api from '@/api/system/sysMenu'\n  export default {\n    name: 'roleAuth',\n\n    data() {\n      return {\n        loading: false, // 用来标识是否正在保存请求中的标识, 防止重复提交\n        sysMenuList: [], // 所有\n        defaultProps: {\n          children: 'children',\n          label: 'name'\n        },\n      };\n    },\n\n    created() {\n      this.fetchData()\n    },\n\n    methods: {\n      /*\n      初始化\n      */\n      fetchData() {\n        const roleId = this.$route.query.id\n        api.toAssign(roleId).then(result => {\n          const sysMenuList = result.data\n          this.sysMenuList = sysMenuList\n          const checkedIds = this.getCheckedIds(sysMenuList)\n          console.log('getPermissions() checkedIds', checkedIds)\n          this.$refs.tree.setCheckedKeys(checkedIds)\n        })\n      },\n\n      /*\n      得到所有选中的id列表\n      */\n      getCheckedIds (auths, initArr = []) {\n        return auths.reduce((pre, item) => {\n          if (item.select && item.children.length === 0) {\n            pre.push(item.id)\n          } else if (item.children) {\n            this.getCheckedIds(item.children, initArr)\n          }\n          return pre\n        }, initArr)\n      },\n\n      /*\n      保存权限列表\n      */\n      save() {\n        debugger\n        //获取到当前子节点\n        //const checkedNodes = this.$refs.tree.getCheckedNodes()\n        //获取到当前子节点及父节点\n        const allCheckedNodes = this.$refs.tree.getCheckedNodes(false, true);\n        let idList = allCheckedNodes.map(node => node.id);\n        console.log(idList)\n        let assginMenuVo = {\n          roleId: this.$route.query.id,\n          menuIdList: idList\n        }\n        this.loading = true\n        api.doAssign(assginMenuVo).then(result => {\n          this.loading = false\n          this.$message.success(result.$message || '分配权限成功')\n          this.$router.push('/system/sysRole');\n        })\n      }\n    }\n  };\n</script>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAqBA,OAAAA,GAAA;AACA;EACAC,IAAA;EAEAC,IAAA,WAAAA,KAAA;IACA;MACAC,OAAA;MAAA;MACAC,WAAA;MAAA;MACAC,YAAA;QACAC,QAAA;QACAC,KAAA;MACA;IACA;EACA;EAEAC,OAAA,WAAAA,QAAA;IACA,KAAAC,SAAA;EACA;EAEAC,OAAA;IACA;AACA;AACA;IACAD,SAAA,WAAAA,UAAA;MAAA,IAAAE,KAAA;MACA,IAAAC,MAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAC,EAAA;MACAf,GAAA,CAAAgB,QAAA,CAAAJ,MAAA,EAAAK,IAAA,WAAAC,MAAA;QACA,IAAAd,WAAA,GAAAc,MAAA,CAAAhB,IAAA;QACAS,KAAA,CAAAP,WAAA,GAAAA,WAAA;QACA,IAAAe,UAAA,GAAAR,KAAA,CAAAS,aAAA,CAAAhB,WAAA;QACAiB,OAAA,CAAAC,GAAA,gCAAAH,UAAA;QACAR,KAAA,CAAAY,KAAA,CAAAC,IAAA,CAAAC,cAAA,CAAAN,UAAA;MACA;IACA;IAEA;AACA;AACA;IACAC,aAAA,WAAAA,cAAAM,KAAA;MAAA,IAAAC,MAAA;MAAA,IAAAC,OAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA;MACA,OAAAH,KAAA,CAAAM,MAAA,WAAAC,GAAA,EAAAC,IAAA;QACA,IAAAA,IAAA,CAAAC,MAAA,IAAAD,IAAA,CAAA5B,QAAA,CAAAwB,MAAA;UACAG,GAAA,CAAAG,IAAA,CAAAF,IAAA,CAAAnB,EAAA;QACA,WAAAmB,IAAA,CAAA5B,QAAA;UACAqB,MAAA,CAAAP,aAAA,CAAAc,IAAA,CAAA5B,QAAA,EAAAsB,OAAA;QACA;QACA,OAAAK,GAAA;MACA,GAAAL,OAAA;IACA;IAEA;AACA;AACA;IACAS,IAAA,WAAAA,KAAA;MAAA,IAAAC,MAAA;MACA;MACA;MACA;MACA;MACA,IAAAC,eAAA,QAAAhB,KAAA,CAAAC,IAAA,CAAAgB,eAAA;MACA,IAAAC,MAAA,GAAAF,eAAA,CAAAG,GAAA,WAAAC,IAAA;QAAA,OAAAA,IAAA,CAAA5B,EAAA;MAAA;MACAM,OAAA,CAAAC,GAAA,CAAAmB,MAAA;MACA,IAAAG,YAAA;QACAhC,MAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAC,EAAA;QACA8B,UAAA,EAAAJ;MACA;MACA,KAAAtC,OAAA;MACAH,GAAA,CAAA8C,QAAA,CAAAF,YAAA,EAAA3B,IAAA,WAAAC,MAAA;QACAoB,MAAA,CAAAnC,OAAA;QACAmC,MAAA,CAAAS,QAAA,CAAAC,OAAA,CAAA9B,MAAA,CAAA6B,QAAA;QACAT,MAAA,CAAAW,OAAA,CAAAb,IAAA;MACA;IACA;EACA;AACA"}]}